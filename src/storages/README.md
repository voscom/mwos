# MWOS3 - битовые хранилища

Битовые хранилища предназначены для хранения параметров модулей контроллера MWOS.
Формат хранимых значений жестко задается при создании модуля.

## Стандартные хранилища
Стандартно MWOS3 содержит 2 хранилища:

- #### Хранилище 0, типа MWOSStorageEEPROM
    Бинарное хранилище в EEPROM (или эмуляторе EEPROM в FLASH).
    Может иметь довольно большой размер, но ограниченное количество перезаписей.
    Необходимо использовать для хранения параметров, которые не часто меняются.
    Использует библиотеку [MWEEPROM](../core/iodev/MWEEPROM.h)
```cpp
    // отключить хранилище EEPROM по умолчанию
    #define MWOSStorageEEPROM_NO 
```
- #### Хранилище 1, типа MWOSStorageStaticRAM
     Универсальное динамическое бинарное хранилище в энергонезависимой памяти.
     Может быть разным, для разных микроконтроллеров.
     Позволяет хранить динамические данные с большим количеством перезаписей (в отличие от EEPROM и FLASH).
     Например: текущие состояния ключей.
     Как правило, имеет небольшой размер. Это могут быть регистры или ОЗУ для RTC или BKP.
     Для хранения этих данных после выключения питания, как правило требуется резервная батарея.
```cpp          
    // отключить хранилище StaticRAM по умолчанию
    #define MWOSStorageStaticRAM_NO 
```

##Отключение стандартных хранилищ
Если необходимо задать меньше двух хранилиш, то необходимо отключить хранилища по умолчанию.

Все вместе:
```cpp          
// отключить все хранилища по умолчанию 
#define MWOS_AUTO_STORAGES_NO 
```
Или по отдельности:
```cpp
// отключить хранилище EEPROM по умолчанию
#define MWOSStorageEEPROM_NO

// отключить хранилище StaticRAM по умолчанию
#define MWOSStorageStaticRAM_NO
```

## Создать свои хранилища
Все хранилища создаются переопределением виртуальных методов класса
[MWOSStorage](../core/MWOSStorage.h). 

Для примера можно посмотреть: [scr/storages/MWOSStorageRAM.h](../storages/MWOSStorageRAM.h).

Или использовать стандартный вывод как тут: [scr/storages/MWOSStorageEEPROM.h](../storages/MWOSStorageEEPROM.h).

Как пример, можно использовать и любые другие хранилища в папке [storages](../storages/).

## Добавить свои хранилища
Стандартные хранилища могут быть заменены на любые другие.
Для этого необходимо отключить настройкой хранилища по умолчанию, и в главном файле ```main.cpp``` в разделе ```setup()```, перед командой ```mwos.start();``` добавить:
```cpp
mwos.AddStorage(new MWOSStorageEEPROM()); // создадим хранилище 0
mwos.AddStorage(new MWOSStorageStaticRAM()); // создадим хранилище 1
mwos.start();
```
По умолчанию можно добавить максимум 2 хранилища. Что-бы поменять максимум хранилищь - используйте настройку:
```cpp          
// максимальное количество хранилищ
#define MWOS_PARAM_STORAGES_COUNT 2
```
Таким образом можно добавить до 8-ми разных хранилищ.
Номер хранилища жестко задается в модуле при создании параметра.
    

