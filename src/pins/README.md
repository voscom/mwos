# MWOS3 - расширители портов
Основано на классе [MWOSPins](../core/MWOSPins.h).
В MWOS порты ввода-вывода задаются типом int16. 
В начале адресного пространства находятся порты микроконтроллера (класс [MWOSPinsMain](MWOSPinsMain.h)).
За портами микроконтроллера, в адресное пространство можно включать порты на расширителях, 
подключенных по любым протоколам.

## Добавление портов ввода-вывода
Для добавление портов ввода-вывода необходимо в главном файле ```main.cpp``` в разделе ```setup()```, перед командой ```mwos.start();``` добавить:
```cpp
 // добавить порты микросхеммы MCP23017 с адреса портов 128. 
 // Аппаратный адрес на i2c = 2 (задано ножками микросхеммы)
mwos.pins.add(new MWOSPinsMCP23017(&Wire,2,128));
// добавить порты микросхеммы AD524x с адреса портов 146. 
// Аппаратный адрес на i2c = 1 (задано ножками микросхеммы)
mwos.pins.add(new MWOSPinsAD524x(&Wire,1,146));
// стартуем MWOS
mwos.start();
```
После этого, любым модулям можно задавать в параметре ```pin``` адреса от 128 до 148. 
При этом будет использован соответствующий порт на MCP23017 или AD524x.
При добавлении портов, MWOS проверяет, чтобы адресные пространства не пересекались.
Если было пересечение - новые порты будут добавлены в начало свободного адресного пространства. 
Команда ```mwos.pins.add``` возвращает обект ```MWOSPins```. 
Можно проверить поле ```MWOSPins.firstPin```, чтобы узнать, куда реально были добавлены новые порты.

Возможное количество добавляемых портов ограничено только адресным пространством 0-32767 

## Поддержка новых микросхемм
Основано на классе [MWOSPins](../core/MWOSPins.h). 
Унаследовав этот класс можно легко добавлять новые микросхеммы портов ввода-вывода.
Для примера, можно посмотреть реализацию [MWOSPinsMCP23017](MWOSPinsMCP23017.h)

## Формат хранения портов
Адресное пространство портов задано типом:
```cpp
#define MWOS_PIN_VALUE_INT mwos_param_int16
```
Для уменьшения используемой оперативной памяти можно уменьшить диапазон адресного пространства, задав:
```cpp
#define MWOS_PIN_VALUE_INT mwos_param_int8
```
Это может быть актуально для маленьких 8-ми битных микроконтроллеров типа: 
Atmel ATTiny, Arduino Nano, STM8 и т.д. Когда требуется экономить каждый байт ОЗУ

